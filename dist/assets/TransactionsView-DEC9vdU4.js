const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TransactionEditor-DkjULvB_.js","assets/index-DRroArCF.js","assets/index-ZI-sGctH.css","assets/index-D7gSHhRF.js"])))=>i.map(i=>d[i]);
import{B as X,o as d,c as m,j as L,x as E,y as Y,k as V,z as Q,e as n,t as P,A as W,d as B,u as R,a as Z,r as p,i as j,C as M,b as o,D as N,S as tt,E as et,G as nt,H as F,s as O,h as A,I as z,f as U,l as at,J as ot,K as st,L as rt,m as it,_ as G,M as lt,F as q,p as H,q as ct,v as dt,w as ut}from"./index-DRroArCF.js";import{s as pt}from"./index-D7gSHhRF.js";var gt=function(f){var e=f.dt;return`
.p-tag {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: `.concat(e("tag.primary.background"),`;
    color: `).concat(e("tag.primary.color"),`;
    font-size: `).concat(e("tag.font.size"),`;
    font-weight: `).concat(e("tag.font.weight"),`;
    padding: `).concat(e("tag.padding"),`;
    border-radius: `).concat(e("tag.border.radius"),`;
    gap: `).concat(e("tag.gap"),`;
}

.p-tag-icon {
    font-size: `).concat(e("tag.icon.size"),`;
    width: `).concat(e("tag.icon.size"),`;
    height:`).concat(e("tag.icon.size"),`;
}

.p-tag-rounded {
    border-radius: `).concat(e("tag.rounded.border.radius"),`;
}

.p-tag-success {
    background: `).concat(e("tag.success.background"),`;
    color: `).concat(e("tag.success.color"),`;
}

.p-tag-info {
    background: `).concat(e("tag.info.background"),`;
    color: `).concat(e("tag.info.color"),`;
}

.p-tag-warn {
    background: `).concat(e("tag.warn.background"),`;
    color: `).concat(e("tag.warn.color"),`;
}

.p-tag-danger {
    background: `).concat(e("tag.danger.background"),`;
    color: `).concat(e("tag.danger.color"),`;
}

.p-tag-secondary {
    background: `).concat(e("tag.secondary.background"),`;
    color: `).concat(e("tag.secondary.color"),`;
}

.p-tag-contrast {
    background: `).concat(e("tag.contrast.background"),`;
    color: `).concat(e("tag.contrast.color"),`;
}
`)},mt={root:function(f){var e=f.props;return["p-tag p-component",{"p-tag-info":e.severity==="info","p-tag-success":e.severity==="success","p-tag-warn":e.severity==="warn","p-tag-danger":e.severity==="danger","p-tag-secondary":e.severity==="secondary","p-tag-contrast":e.severity==="contrast","p-tag-rounded":e.rounded}]},icon:"p-tag-icon",label:"p-tag-label"},ft=X.extend({name:"tag",theme:gt,classes:mt}),vt={name:"BaseTag",extends:W,props:{value:null,severity:null,rounded:Boolean,icon:String},style:ft,provide:function(){return{$pcTag:this,$parentInstance:this}}},J={name:"Tag",extends:vt,inheritAttrs:!1};function yt(a,f,e,v,x,i){return d(),m("span",E({class:a.cx("root")},a.ptmi("root")),[a.$slots.icon?(d(),L(Y(a.$slots.icon),E({key:0,class:a.cx("icon")},a.ptm("icon")),null,16,["class"])):a.icon?(d(),m("span",E({key:1,class:[a.cx("icon"),a.icon]},a.ptm("icon")),null,16)):V("",!0),a.value!=null||a.$slots.default?Q(a.$slots,"default",{key:2},function(){return[n("span",E({class:a.cx("label")},a.ptm("label")),P(a.value),17)]}):V("",!0)],16)}J.render=yt;const _t={class:"bg-white rounded-lg p-3 flex gap-2"},ht={class:"bg-slate-100 p-2 rounded-full flex-shrink-0 flex"},bt={key:0,class:"text-[--p-primary-500] pi pi-arrow-circle-up"},$t={key:1,class:"text-red-500 self-end pi pi-arrow-circle-down"},wt={class:"w-full"},kt={class:"flex items-center gap-2 justify-between w-full min-w-0"},Tt={class:"truncate"},Pt={class:"flex items-end gap-2 justify-between w-full min-w-0"},xt={class:"md:text-lg font-semibold"},St={class:"text-xs text-slate-500"},Dt={class:"mt-2 flex items-center gap-2 justify-between"},Vt=B({__name:"TransactionItem",props:{transaction:{}},emits:["delete-transaction","update-transaction"],setup(a,{emit:f}){const e=R(),v=Z(),x=nt({loader:()=>z(()=>import("./TransactionEditor-DkjULvB_.js"),__vite__mapDeps([0,1,2,3]))}),i=p({successful:"success",pending:"warn",failed:"danger"}),S=j(()=>i.value[a.transaction.status]),b=f,h=p(!1),l=p(null),k=async()=>{await A(`api/transactions/${a.transaction._id}`,{loading:h,error:l,config:{router:e,method:"DELETE"}},()=>{b("delete-transaction",a.transaction)})},y=()=>{v.require({message:"Do you want to delete this transaction?",header:"Delete Transaction",icon:"pi pi-info-circle",rejectLabel:"Cancel",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Delete",severity:"danger"},accept:()=>{k()}})},$=p(!1);return(r,t)=>{const _=F,s=J,u=O;return d(),m("div",_t,[(d(),L(tt,null,{default:M(()=>[o(N(x),{onUpdateTransaction:t[0]||(t[0]=c=>r.$emit("update-transaction",c)),visible:$.value,"onUpdate:visible":t[1]||(t[1]=c=>$.value=c),transaction:r.transaction},null,8,["visible","transaction"])]),fallback:M(()=>[o(_,{header:"Edit Transaction",visible:$.value,"onUpdate:visible":t[2]||(t[2]=c=>$.value=c)},{default:M(()=>t[4]||(t[4]=[n("div",{class:"h-60 flex items-center justify-center"},"Loading...",-1)])),_:1},8,["visible"])]),_:1})),n("div",ht,[r.transaction.type==="deposit"?(d(),m("span",bt)):(d(),m("span",$t))]),n("div",wt,[n("div",kt,[n("h1",Tt,P(r.transaction.title),1),o(s,{value:r.transaction.status,severity:S.value,class:"py-1 px-2 text-xs"},null,8,["value","severity"])]),n("div",Pt,[n("h1",xt,P(r.transaction.type==="deposit"?"+":"-")+"₩"+P(r.transaction.amountPaid.toLocaleString()),1),n("p",St,P(N(et)(r.transaction.transactionDate,"dd MM, yyyy T")),1)]),n("div",Dt,[o(u,{onClick:t[3]||(t[3]=c=>$.value=!0),size:"small",severity:"secondary",label:"Edit",icon:"pi pi-file-edit",class:"py-1 px-2"}),o(u,{onClick:y,loading:h.value,size:"small",severity:"danger",icon:"pi pi-trash",class:"py-1 px-2"},null,8,["loading"])])])])}}}),Mt={class:"grid gap-4"},Ct={class:"form-control"},Et={class:"mt-1"},Lt={class:"form-control"},At={key:0,class:"text-red-500"},It={class:"form-control"},Ut={class:"form-control"},zt={class:"form-control"},Bt={class:"form-control mt-2"},Rt=B({__name:"TransactionCreator",emits:["add-transaction"],setup(a,{emit:f}){const e=R(),v=p(!1),x=f,i=p({type:"deposit",status:"successful"}),S=j(()=>i.value.type==="deposit"?"Property Sale":"Property Purchase"),b=p(!1),h=p(null),l=p(!1),k=async()=>{if(l.value=!1,!i.value.amountPaid){l.value=!0;return}const r=await y(i.value);await A("api/transactions",{loading:b,error:h,config:{router:e,method:"POST",body:r}},t=>{v.value=!1,x("add-transaction",t.item)})};async function y(r){const t=r.title||S.value,_=r.amountPaid??0,s=[.02,.05,.08,.1,.12,.15,.18,.2],u=s[Math.floor(Math.random()*s.length)],c=Math.round(_*u),C=Math.max(Math.round(_-c),0),[T,D]=await Promise.all([z(()=>import("./customers-C0e4AJWQ.js"),[]),z(()=>import("./locations-DF6UexsP.js"),[])]),w=[Math.floor(Math.random()*T.default.length),Math.floor(Math.random()*D.default.length)],I=T.default[w[0]],g=D.default[w[1]],K=r.description||`${r.type==="deposit"?"Sale":"Purchase"} of property at ${g}`;return{title:t,amount:C,charges:c,amountPaid:_,type:r.type??"deposit",status:r.status??"successful",recipientName:I,transactionDate:new Date(Date.now()),transactionRef:$(),description:K}}function $(){const r="TXN",t=new Date,_=`${t.getFullYear()}${(t.getMonth()+1).toString().padStart(2,"0")}${t.getDate().toString().padStart(2,"0")}`,s=`${t.getHours().toString().padStart(2,"0")}${t.getMinutes().toString().padStart(2,"0")}${t.getSeconds().toString().padStart(2,"0")}`,u=Math.floor(1e3+Math.random()*9e3);return`${r}${_}${s}${u}`}return(r,t)=>{const _=O,s=at,u=ot,c=st,C=rt,T=it,D=pt,w=G,I=F;return d(),m("div",null,[o(_,{onClick:t[0]||(t[0]=g=>v.value=!0),label:"Add",icon:"pi pi-plus"}),o(I,{header:"New Transaction",visible:v.value,"onUpdate:visible":t[6]||(t[6]=g=>v.value=g),modal:"",class:"md:w-96"},{default:M(()=>[n("div",Mt,[n("div",Ct,[t[8]||(t[8]=n("label",{for:"title"},[U("Title "),n("small",{class:"font-semibold"},"(optional)")],-1)),o(s,{modelValue:i.value.title,"onUpdate:modelValue":t[1]||(t[1]=g=>i.value.title=g),id:"title",placeholder:"Transaction title"},null,8,["modelValue"]),n("small",Et,[t[7]||(t[7]=U("If you don't enter a title, the default will be: ")),n("b",null,P(S.value),1)])]),n("div",Lt,[t[10]||(t[10]=n("label",{for:"amount"},"Amount",-1)),o(C,null,{default:M(()=>[o(u,null,{default:M(()=>t[9]||(t[9]=[U("₩")])),_:1}),o(c,{modelValue:i.value.amountPaid,"onUpdate:modelValue":t[2]||(t[2]=g=>i.value.amountPaid=g),placeholder:"Amount"},null,8,["modelValue"])]),_:1}),l.value?(d(),m("small",At,"Enter an amount")):V("",!0)]),n("div",It,[t[11]||(t[11]=n("label",{for:"type"},"Transaction Type",-1)),o(T,{modelValue:i.value.type,"onUpdate:modelValue":t[3]||(t[3]=g=>i.value.type=g),"input-id":"type",options:["deposit","withdrawal"]},null,8,["modelValue"])]),n("div",Ut,[t[12]||(t[12]=n("label",{for:"status"},"Transaction Status",-1)),o(T,{modelValue:i.value.status,"onUpdate:modelValue":t[4]||(t[4]=g=>i.value.status=g),"input-id":"status",options:["successful","pending","failed"]},null,8,["modelValue"])]),n("div",zt,[t[13]||(t[13]=n("label",{for:"description"},"Description",-1)),o(D,{modelValue:i.value.description,"onUpdate:modelValue":t[5]||(t[5]=g=>i.value.description=g),id:"description",rows:"4"},null,8,["modelValue"])]),o(w,{error:h.value,"show-header":""},null,8,["error"]),n("div",Bt,[o(_,{label:"Add",icon:"pi pi-plus",loading:b.value,onClick:k},null,8,["loading"])])])]),_:1},8,["visible"])])}}}),jt={},Nt={class:"grid gap-4"},Ft={class:"flex flex-col gap-2"},Ot={class:"flex flex-col items-end gap-1 justify-between"};function Gt(a,f){const e=ct;return d(),m("div",Nt,[(d(),m(q,null,H(3,v=>n("div",{key:v,class:"bg-white rounded-lg p-4 grid grid-cols-2 gap-2"},[n("div",Ft,[o(e,{height:"1rem",width:"70%"}),o(e,{height:"1.3rem",width:"10rem"}),o(e,{height:"2rem",width:"5rem"})]),n("div",Ot,[o(e,{height:"0.8rem",width:"8rem"}),o(e,{height:"1rem",width:"70%"}),o(e,{height:"2rem",width:"3rem"})])])),64))])}const qt=lt(jt,[["render",Gt]]),Ht={class:"p-4 lg:p-0 md:h-[calc(100dvh-7rem)]"},Jt={class:"fixed z-[100] top-2 right-16 lg:top-6 lg:right-8 flex items-center gap-2"},Kt={key:0,class:"font-bold text-[--p-primary-color]"},Xt={key:1,class:"grid gap-2 mb-4"},Wt=B({__name:"TransactionsView",setup(a){const f=R(),e=p(0),v=p(0),x=s=>{v.value=s.page,k()},i=p(10),S=j(()=>i.value*v.value),b=p(!1),h=p(null),l=p(null);async function k(){await A(`api/transactions?skip=${S.value}&limit=${i.value}&sort=transactionDate,desc`,{loading:b,error:h,config:{router:f,cache:!0}},s=>{l.value=s.items})}const y=p();async function $(){await A("api/transactions-count",{loading:b,error:h,config:{router:f,cache:!0}},s=>{y.value=s.count})}dt(async()=>{await Promise.all([$(),k()])});const r=s=>{l.value=l.value?[s,...l.value]:[s],y.value=(y.value??0)+1},t=s=>{var u;l.value&&(l.value=(u=l.value)==null?void 0:u.filter(c=>c._id!==s._id),y.value=Math.max((y.value??0)-1,0))},_=s=>{if(!l.value)return;const u=l.value.findIndex(c=>c._id===s._id);l.value[u]=s};return(s,u)=>{const c=Rt,C=G,T=Vt,D=ut;return d(),m("main",Ht,[n("div",Jt,[y.value?(d(),m("p",Kt," ("+P(y.value)+") ",1)):V("",!0),o(c,{onAddTransaction:r})]),b.value?(d(),L(qt,{key:0})):V("",!0),o(C,{error:h.value,"show-retry-button":"",onRetry:k,"show-header":""},null,8,["error"]),!b.value&&!h.value&&l.value?(d(),m("div",Xt,[(d(!0),m(q,null,H(l.value,w=>(d(),L(T,{key:w._id,transaction:w,onDeleteTransaction:t,onUpdateTransaction:_},null,8,["transaction"]))),128))])):V("",!0),n("div",null,[o(D,{first:e.value,"onUpdate:first":u[0]||(u[0]=w=>e.value=w),onPage:x,rows:i.value,totalRecords:y.value,template:"FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink"},null,8,["first","rows","totalRecords"])])])}}});export{Wt as default};
