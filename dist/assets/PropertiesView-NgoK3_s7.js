import{d as T,N as F,r as n,O as J,u as N,P as W,o as d,j as I,C as X,c,e as o,b as s,f as S,k as b,h as M,l as Y,K as Z,m as ee,s as R,Q as te,_ as O,M as oe,F as q,p as H,q as le,a as se,i as re,v as ae,t as D,R as ie,T as ne,w as ue}from"./index-86hFw57B.js";import{s as de}from"./index-DVyWtYDF.js";const ce={key:0},pe={class:"grid gap-4 md:grid-cols-4"},me={class:"form-control md:col-span-3"},ve={class:"form-control"},fe={class:"form-control md:col-span-4"},_e={class:"form-control"},ge={class:"form-control"},he={class:"form-control"},ye={class:"form-control"},be={class:"form-control md:col-span-4"},we={class:"grid gap-4"},Ve={class:"form-control md:col-span-4"},xe={class:"form-control md:col-span-4"},Pe=T({__name:"PropertyEditor",props:F({property:{default:null}},{visible:{default:!1},visibleModifiers:{}}),emits:F(["update-property"],["update:visible"]),setup(w,{emit:_}){var v,x,j,E,C,U;const t=n(w.property),a=n({picture_1:((x=(v=t.value)==null?void 0:v.pictures)==null?void 0:x[0])??"",picture_2:((E=(j=t.value)==null?void 0:j.pictures)==null?void 0:E[1])??"",picture_3:((U=(C=t.value)==null?void 0:C.pictures)==null?void 0:U[2])??""});J(()=>w.property,L=>{var e,p,f,h,P,$;t.value=L,a.value={picture_1:((p=(e=t.value)==null?void 0:e.pictures)==null?void 0:p[0])??"",picture_2:((h=(f=t.value)==null?void 0:f.pictures)==null?void 0:h[1])??"",picture_3:(($=(P=t.value)==null?void 0:P.pictures)==null?void 0:$[2])??""}});const m=_,u=N(),y=W(w,"visible"),g=n(!1),V=n(null),k=async()=>{t.value&&(t.value.pictures=Object.values(a.value),await M(`api/properties/${t.value._id}`,{loading:g,error:V,config:{router:u,method:"PUT",body:t.value}},()=>{m("update-property",t.value)}))};return(L,e)=>{const p=Y,f=Z,h=ee,P=de,$=R,r=te;return d(),I(r,{visible:y.value,"onUpdate:visible":e[11]||(e[11]=l=>y.value=l),header:"Edit Property",position:"bottom",class:"h-auto max-h-[80dvh]"},{default:X(()=>[t.value?(d(),c("div",ce,[o("div",pe,[o("div",me,[e[12]||(e[12]=o("label",{for:"name"},"Name",-1)),s(p,{modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.name=l),modelModifiers:{trim:!0},fluid:""},null,8,["modelValue"])]),o("div",ve,[e[13]||(e[13]=o("label",{for:"price"},"Price",-1)),s(f,{modelValue:t.value.price,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.price=l),fluid:""},null,8,["modelValue"])]),o("div",fe,[e[14]||(e[14]=o("label",{for:"address"},"Address",-1)),s(p,{modelValue:t.value.address,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.address=l),modelModifiers:{trim:!0},fluid:""},null,8,["modelValue"])]),o("div",_e,[e[15]||(e[15]=o("label",{for:"type"},"Type",-1)),s(h,{modelValue:t.value.type,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.type=l),options:["rent","sale"],fluid:""},null,8,["modelValue"])]),o("div",ge,[e[16]||(e[16]=o("label",{for:"area"},[S("Area (m"),o("sup",null,"2"),S(")")],-1)),s(f,{modelValue:t.value.area,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.area=l),fluid:""},null,8,["modelValue"])]),o("div",he,[e[17]||(e[17]=o("label",{for:"bedrooms"},"Bedrooms",-1)),s(h,{modelValue:t.value.bedrooms,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.bedrooms=l),options:[1,2,3,4,5,6,7,8,9,10],fluid:""},null,8,["modelValue"])]),o("div",ye,[e[18]||(e[18]=o("label",{for:"bathrooms"},"Bathrooms",-1)),s(h,{modelValue:t.value.bathrooms,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.bathrooms=l),options:[1,2,3,4,5,6,7,8,9,10],fluid:""},null,8,["modelValue"])]),o("div",be,[e[19]||(e[19]=o("label",{for:"pictures"},[S("Pictures "),o("small",null,"Enter the picture url")],-1)),o("div",we,[s(p,{modelValue:a.value.picture_1,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.picture_1=l),modelModifiers:{trim:!0},fluid:""},null,8,["modelValue"]),s(p,{modelValue:a.value.picture_2,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.picture_2=l),modelModifiers:{trim:!0},fluid:""},null,8,["modelValue"]),s(p,{modelValue:a.value.picture_3,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.picture_3=l),modelModifiers:{trim:!0},fluid:""},null,8,["modelValue"])])]),o("div",Ve,[e[20]||(e[20]=o("label",{for:"description"},"Description",-1)),s(P,{modelValue:t.value.description,"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.description=l),rows:"6",fluid:"",class:"resize-none"},null,8,["modelValue"])]),o("div",xe,[s($,{onClick:k,loading:g.value,label:"Save",icon:"pi pi-check",class:"md"},null,8,["loading"])])])])):b("",!0)]),_:1},8,["visible"])}}}),$e=T({__name:"PropertyCreator",emits:["add-property"],setup(w,{emit:_}){const t=N(),a=_,m=n(!1),u=n(null),y=async()=>{await M("api/properties",{loading:m,error:u,config:{router:t,method:"POST"}},g=>{a("add-property",g.property)})};return(g,V)=>{const k=R,v=O;return d(),c("div",null,[s(k,{onClick:y,loading:m.value,label:"Add",icon:"pi pi-plus"},null,8,["loading"]),s(v,{error:u.value,overlay:"","show-header":""},null,8,["error"])])}}}),ke={},Ce={class:"grid gap-4"},Ue={class:"h-28 md:h-auto w-full md:max-w-44"},De={class:"flex-grow flex flex-col gap-2 justify-between"},Me={class:"flex items-center gap-2 justify-end md:justify-normal"};function je(w,_){const t=le;return d(),c("div",Ce,[(d(),c(q,null,H(3,a=>o("div",{key:a,class:"bg-white rounded-lg p-4 flex flex-col gap-2 md:flex-row"},[o("div",Ue,[s(t,{height:"100%",width:"100%"})]),o("div",De,[s(t,{height:"1.5rem",width:"100%"}),s(t,{height:"1rem",width:"80%"}),s(t,{height:"1.5rem",width:"10rem"}),s(t,{height:"0.8rem",width:"4rem"}),o("div",Me,[s(t,{height:"2rem",width:"5rem"}),s(t,{height:"2rem",width:"5rem"})])])])),64))])}const Ee=oe(ke,[["render",je]]),Le={class:"w-full p-4 lg:w-full min-w-0 lg:p-0 overflow-y-auto h-full md:h-[calc(100vh-6rem)] lg:h-[calc(100vh-7rem)]"},Be={class:"fixed z-[100] top-2 right-16 lg:top-6 lg:right-8 flex items-center gap-2"},Se={key:0,class:"font-bold text-[--p-primary-color]"},Te={class:"grid place-content-center h-60"},Ne={key:1},Re={class:"grid gap-2 mb-4"},Ae={class:"w-full h-28 md:h-36 md:w-[40%] md:max-w-44 bg-slate-200 rounded-lg overflow-hidden"},ze=["src"],Fe={class:"flex flex-col justify-between"},Ie={class:"text-lg font-semibold"},Oe={key:0,class:"text-slate-500 font-medium"},qe={class:"md:text-lg font-semibold"},He={class:"text-sm text-slate-500"},Ke={class:"font-semibold"},Qe={class:"flex items-center mt-2 md:mt-0 gap-2 justify-end md:justify-normal"},Ge={key:0},Xe=T({__name:"PropertiesView",setup(w){const _=N(),t=se(),a=n(!1),m=n(null),u=n(null),y=n(0),g=n(0),V=n(20),k=re(()=>V.value*g.value),v=n(null),x=async()=>{await M(`api/properties?skip=${k.value}&limit=${V.value}`,{loading:a,error:m,config:{router:_,cache:!0}},r=>{u.value=r.items})},j=r=>{g.value=r.page,x()},E=async()=>{await M("api/properties-count",{loading:a,error:m,config:{router:_,cache:!0}},r=>{v.value=r.count,sessionStorage.setItem("propertiesCount",r.count.toString())})},C=n(!1),U=n(null),L=async r=>{await M(`api/properties/${r}`,{loading:C,error:U,config:{router:_,method:"DELETE"}},()=>{u.value&&(u.value=u.value.filter(l=>l._id!==r))})},e=r=>{t.require({message:"Do you want to delete this property?",header:"Delete Property",icon:"pi pi-info-circle",rejectLabel:"Cancel",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Delete",severity:"danger"},accept:()=>{L(r)}})};ae(async()=>{await Promise.all([E(),x()])});const p=n(null),f=n(!1),h=r=>{p.value=r,f.value=!0},P=r=>{if(u.value){const l=u.value.findIndex(B=>B._id===r._id);u.value[l]=r}f.value=!1},$=r=>{u.value&&u.value.unshift(r)};return(r,l)=>{const B=$e,K=Pe,A=O,z=R,Q=ue;return d(),c("main",Le,[o("div",Be,[v.value?(d(),c("p",Se," ("+D(v.value)+") ",1)):b("",!0),s(B,{onAddProperty:$})]),s(K,{visible:f.value,"onUpdate:visible":l[0]||(l[0]=i=>f.value=i),property:p.value,onUpdateProperty:P},null,8,["visible","property"]),a.value?(d(),I(Ee,{key:0})):b("",!0),ie(o("div",Te,[s(A,{error:m.value,"show-retry-button":"",onRetry:x},null,8,["error"])],512),[[ne,m.value]]),!a.value&&!m.value&&u.value?(d(),c("section",Ne,[o("div",Re,[(d(!0),c(q,null,H(u.value,i=>(d(),c("div",{key:i._id,class:"flex gap-2 flex-col md:flex-row bg-white rounded-lg p-4"},[o("div",Ae,[i.pictures?(d(),c("img",{key:0,src:i.pictures[0]||i.pictures[1]||i.pictures[2],class:"w-full h-full object-cover"},null,8,ze)):b("",!0)]),o("div",Fe,[o("h1",Ie,D(i.name??i.address),1),i.name?(d(),c("p",Oe,D(i.address),1)):b("",!0),o("h1",qe,"â‚©"+D(i.price.toLocaleString()),1),o("div",He,[l[2]||(l[2]=o("span",null,"For: ",-1)),o("span",Ke,D(i.type),1)]),o("div",Qe,[s(z,{onClick:G=>h(i),size:"small",severity:"secondary",label:"Update",icon:"pi pi-pencil"},null,8,["onClick"]),s(z,{onClick:G=>e(i._id),loading:C.value,size:"small",severity:"danger",label:"Delete",icon:"pi pi-trash"},null,8,["onClick","loading"])])])]))),128))]),v.value?(d(),c("div",Ge,[s(Q,{first:y.value,"onUpdate:first":l[1]||(l[1]=i=>y.value=i),onPage:j,rows:V.value,totalRecords:v.value,template:"FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink"},null,8,["first","rows","totalRecords"])])):b("",!0),s(A,{error:U.value,showHeader:"",overlay:""},null,8,["error"])])):b("",!0)])}}});export{Xe as default};
