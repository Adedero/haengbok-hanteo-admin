import{d as C,u as E,a as j,r as o,o as r,c as p,b as l,e as t,f as q,s as B,_ as M,g as A,h as U,i as N,t as L,j as V,k,l as G,m as H,n as I,F as T,p as z,q as O,v as J,w as K}from"./index-COWLTr48.js";const Q=C({__name:"PasswordReset",props:{user:{}},emits:["password-reset"],setup(h){const _=E(),g=j(),i=o(!1),f=o(null),s=o(!1),a=async()=>{await U(`api/user-password-reset/${h.user._id}`,{loading:i,error:f,config:{router:_,method:"PUT"}},()=>{s.value=!0})},y=()=>{g.require({message:"Do you want to reset the user's password?",header:"Reset Password",icon:"pi pi-info-circle",rejectLabel:"Cancel",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Reset",severity:"danger"},accept:()=>{a()}})};return(v,n)=>{const w=B,d=M,x=A;return r(),p("div",null,[l(w,{onClick:y,loading:i.value,severity:"danger",label:"Reset Password",icon:"pi pi-key",fluid:""},null,8,["loading"]),n[2]||(n[2]=t("small",{class:"text-red-500"},[q(" Reset the user's password to "),t("span",{class:"font-semibold"},"000000")],-1)),l(d,{error:f.value,overlay:"","show-header":""},null,8,["error"]),l(x,{onHide:n[0]||(n[0]=P=>v.$emit("password-reset")),visible:s.value,"onUpdate:visible":n[1]||(n[1]=P=>s.value=P),"show-okay-button":"",overlay:"",message:"Password has been reset successfully to 000000"},null,8,["visible"])])}}}),W={class:"bg-white rounded-lg p-4 w-full"},X={class:"flex items-center justify-between"},Y={class:"flex items-center gap-1"},Z={class:"font-medium"},ee={class:"flex items-center gap-1"},se={key:0,class:"flex items-center gap-2"},te={class:"mt-4 grid md:grid-cols-2 gap-4"},le={class:"md:col-span-2"},ae=C({__name:"UserDetails",props:{user:{},index:{}},emits:["deleteUser"],setup(h,{emit:_}){const g=E(),i=j(),f=_,s=o({...h.user,birthday:new Date(h.user.birthday)}),a=o(!1),y=N(()=>Object.values(s.value).some(m=>m===""||m===null||m===void 0)||!s.value.location.country),v=o(!1),n=o(null),w=async()=>{await U(`api/users/${s.value._id}`,{loading:v,error:n,config:{router:g,method:"PUT",body:s.value}},()=>{a.value=!1})},d=o(!1),x=o(null),P=async()=>{await U(`api/users/${s.value._id}`,{loading:d,error:x,config:{router:g,method:"DELETE"}},()=>{f("deleteUser",s.value._id)})},c=()=>{i.require({message:"Do you want to delete this user? This action cannot be reversed.",header:"Delete User",icon:"pi pi-info-circle",rejectLabel:"Cancel",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Delete",severity:"danger"},accept:()=>{P()}})};return(m,e)=>{const $=B,D=M,b=G,R=H,S=I,F=Q;return r(),p("div",W,[t("div",X,[t("div",Y,[t("p",null,L(m.index+1)+".",1),t("p",Z,L(s.value.name),1)]),t("div",ee,[a.value?k("",!0):(r(),V($,{key:0,onClick:e[0]||(e[0]=u=>a.value=!0),size:"small",label:"Edit",icon:"pi pi-user-edit"})),a.value?k("",!0):(r(),V($,{key:1,onClick:c,size:"small",label:"Delete",icon:"pi pi-trash",severity:"danger",loading:d.value},null,8,["loading"]))]),a.value?(r(),p("div",se,[l($,{onClick:w,disabled:y.value,loading:v.value,size:"small",label:"Save",icon:"pi pi-check"},null,8,["disabled","loading"]),l($,{onClick:e[1]||(e[1]=u=>a.value=!1),size:"small",severity:"secondary",label:"Cancel",icon:"pi pi-times"})])):k("",!0)]),e[13]||(e[13]=t("hr",{class:"my-2"},null,-1)),l(D,{error:x.value,closable:""},null,8,["error"]),t("div",te,[t("div",null,[e[8]||(e[8]=t("label",{for:"name",class:"text-sm text-slate-500 font-medium"},"Name",-1)),l(b,{modelValue:s.value.name,"onUpdate:modelValue":e[2]||(e[2]=u=>s.value.name=u),modelModifiers:{trim:!0},id:"name",fluid:"",disabled:!a.value},null,8,["modelValue","disabled"])]),t("div",null,[e[9]||(e[9]=t("label",{for:"gender",class:"text-sm text-slate-500 font-medium"},"Gender",-1)),l(R,{modelValue:s.value.gender,"onUpdate:modelValue":e[3]||(e[3]=u=>s.value.gender=u),options:["female","male","other"],"input-id":"gender",fluid:"",disabled:!a.value},null,8,["modelValue","disabled"])]),t("div",le,[e[10]||(e[10]=t("label",{for:"email",class:"text-sm text-slate-500 font-medium"},"Email",-1)),l(b,{modelValue:s.value.email,"onUpdate:modelValue":e[4]||(e[4]=u=>s.value.email=u),type:"email",id:"email",fluid:"",disabled:!a.value},null,8,["modelValue","disabled"])]),t("div",null,[e[11]||(e[11]=t("label",{for:"birthday",class:"text-sm text-slate-500 font-medium"},"Birthday",-1)),l(S,{modelValue:s.value.birthday,"onUpdate:modelValue":e[5]||(e[5]=u=>s.value.birthday=u),"input-id":"birthday",dateFormat:"dd MM, yy",fluid:"",disabled:!a.value},null,8,["modelValue","disabled"])]),t("div",null,[e[12]||(e[12]=t("label",{for:"location",class:"text-sm text-slate-500 font-medium"},"Location",-1)),l(b,{modelValue:s.value.location.country,"onUpdate:modelValue":e[6]||(e[6]=u=>s.value.location.country=u),id:"location",fluid:"",disabled:!a.value},null,8,["modelValue","disabled"])]),a.value?(r(),V(F,{key:0,user:s.value,onPasswordReset:e[7]||(e[7]=u=>a.value=!1)},null,8,["user"])):k("",!0)])])}}}),oe={class:"grid gap-4"},ne=C({__name:"PageLoader",setup(h){return(_,g)=>{const i=O;return r(),p("div",oe,[(r(),p(T,null,z(3,f=>t("div",{key:f,class:"bg-white rounded-lg p-4 grid grid-cols-2 gap-4"},[l(i,{height:"2.5rem",class:"col-span-1"}),l(i,{height:"2.5rem",class:"col-span-1"}),l(i,{height:"2.5rem",class:"col-span-2"}),l(i,{height:"2.5rem",class:"col-span-1"}),l(i,{height:"2.5rem",class:"col-span-1"})])),64))])}}}),re={class:"p-4 lg:p-0 md:h-[calc(100dvh-7rem)]"},ie={class:"fixed z-[100] top-2 right-16 lg:top-6 lg:right-8 flex items-center gap-2"},ue={key:0,class:"font-bold text-[--p-primary-color]"},de={key:1,class:"grid gap-2 mb-4"},me=C({__name:"UsersView",setup(h){const _=E(),g=o(0),i=o(0),f=c=>{i.value=c.page,w()},s=o(10),a=N(()=>s.value*i.value),y=o(!1),v=o(null),n=o(null);async function w(){await U(`api/users?skip=${a.value}&limit=${s.value}`,{loading:y,error:v,config:{router:_,cache:!0}},c=>{n.value=c.items})}const d=o();async function x(){await U("api/users-count",{loading:y,error:v,config:{router:_,cache:!0}},c=>{d.value=c.count})}const P=c=>{n.value&&(n.value=n.value.filter(m=>m._id!==c),d.value=Math.max((d.value??0)-1,0))};return J(async()=>{await Promise.all([w(),x()])}),(c,m)=>{const e=M,$=ae,D=K;return r(),p("main",re,[t("div",ie,[d.value?(r(),p("p",ue," ("+L(d.value)+") ",1)):k("",!0)]),y.value?(r(),V(ne,{key:0})):k("",!0),l(e,{error:v.value,"show-retry-button":"",onRetry:w,"show-header":""},null,8,["error"]),!y.value&&!v.value&&n.value?(r(),p("div",de,[(r(!0),p(T,null,z(n.value,(b,R)=>(r(),p("div",{key:b._id},[l($,{user:b,index:R,onDeleteUser:P},null,8,["user","index"])]))),128))])):k("",!0),t("div",null,[l(D,{first:g.value,"onUpdate:first":m[0]||(m[0]=b=>g.value=b),onPage:f,rows:s.value,totalRecords:d.value,template:"FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink"},null,8,["first","rows","totalRecords"])])])}}});export{me as default};
